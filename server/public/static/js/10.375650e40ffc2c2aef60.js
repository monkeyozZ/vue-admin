webpackJsonp([10],{N3UJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),i=a.n(r),s=a("Xxa5"),l=a.n(s),o=a("exGp"),n=a.n(o),c=a("mtWM"),m=a.n(c),u=a("9TmC"),d={props:{edit:{type:Boolean,default:!1},editArr:{type:Object,default:function(){}},editId:{type:String,default:""}},data:function(){var e,t,a=this,r=(e=n()(l.a.mark(function e(t,r,i){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:0===r.length&&i(new Error("至少选择一项标签"));case 1:case"end":return e.stop()}},e,a)})),function(t,a,r){return e.apply(this,arguments)});return{baseapi:"http://api.wowmonkey.cn",category:[{label:"学无止境",value:"learn"},{label:"个人归档",value:"note"},{label:"慢生活",value:"life"}],tags:["js","java","php"],origin:[{label:"原创",value:"0"},{label:"转载",value:"1"},{label:"混合",value:"2"}],Form:{title:"",keywords:"",des:"",category:[],tag:[],content:"",origin:"0",status:!0,open:!0,imageUrl:""},rules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"}],keywords:[{required:!0,message:"请输入文章关键词",trigger:"blur"}],des:[{required:!0,message:"请输入文章描述",trigger:"blur"}],category:[{validator:(t=n()(l.a.mark(function e(t,r,i){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:0===r.length&&i(new Error("至少选择一项分类"));case 1:case"end":return e.stop()}},e,a)})),function(e,a,r){return t.apply(this,arguments)}),trigger:"blur"}],tag:[{validator:r,trigger:"blur"}],content:[{required:!0,message:"请输入文章内容",trigger:"blur"}]},dialogImageUrl:"",dialogVisible:!1,content_img_arr:[]}},methods:{getTagList:function(){var e=this;u.a.getTaglist().then(function(t){0===t.data.code&&(e.tags=t.data.tagList)})},refresh:function(){window.onbeforeunload=function(){return"请确认信息是否已保存！"}},imgAdd:function(e,t){var a=this,r=new FormData;r.append("image",t),m()({url:this.baseapi+"/article/contentimg",method:"post",data:r,headers:{"Content-Type":"multipart/form-data"}}).then(function(r){if(0===r.data.code){var i={};i[t.name]=r.data.imageUrl,a.content_img_arr.push(i),a.$refs.md.$img2Url(e,a.baseapi+r.data.imageUrl)}})},imgDel:function(e){var t=this,a="";this.content_img_arr.map(function(t){for(var r in t)e[0].name===r&&(a=t[e[0].name])}),u.a.delcontentimg(a).then(function(e){0===e.data.code&&t.$notify({type:"success",title:"成功",message:e.data.message})})},handleThumbSuccess:function(e,t){0===e.code&&(this.Form.imageUrl=e.imageUrl)},beforeThumbUpload:function(e){var t=e.size/1024/1024<10;return t||this.$message.error("上传头像图片大小不能超过 10MB!"),t},editArticle:function(){var e=this;this.$refs.dataForm1.validate(function(t){t&&u.a.editOneArticle(e.editId,e.Form).then(function(t){0===t.data.code&&(e.$emit("changeEditdialogVisible"),e.$notify({type:"success",title:"成功",message:"文章修改成功"}))})})},submit:function(){var e=this;this.$refs.dataForm1.validate(function(t){t&&(e.Form.imageUrl?u.a.insert(i()(e.Form)).then(function(t){0===t.data.code&&(e.$notify({type:"success",title:"成功",message:"文章添加成功"}),e.$router.push("/article/index"))}).catch(function(t){e.$notify({type:"error",title:"失败",message:t})}):e.$notify({type:"warning",title:"警告",message:"请选择要上传的缩略图"}))})}},watch:{editArr:{handler:function(){var e=this.editArr,t=e.title,a=e.keywords,r=e.des,i=e.category,s=e.tag,l=e.content,o=e.origin,n=e.status,c=e.open,m=e.imageUrl;this.Form.title=t,this.Form.keywords=a,this.Form.des=r,this.Form.category=i,this.Form.tag=s,this.Form.content=l,this.Form.origin=o,this.Form.status=n,this.Form.open=c,this.Form.imageUrl=m}}},mounted:function(){this.getTagList(),this.refresh()}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article_container"},[e.edit?e._e():a("el-breadcrumb",{staticClass:"path",attrs:{"separator-class":"el-icon-arrow-right"}},[a("span",{staticStyle:{float:"left"}},[e._v("当前位置：")]),e._v(" "),a("el-breadcrumb-item",[e._v("文章管理")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/article/insert"}}},[e._v("添加文章")])],1),e._v(" "),a("el-row",[a("el-col",{staticClass:"form-left",class:{resetBg:e.edit},attrs:{lg:17,md:17,sm:24,xs:24}},[a("el-form",{ref:"dataForm1",attrs:{rules:e.rules,model:e.Form,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"文章标题：",prop:"title","inline-message":!0}},[a("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"文章标题"},model:{value:e.Form.title,callback:function(t){e.$set(e.Form,"title",t)},expression:"Form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文章关键词：",prop:"keywords","inline-message":!0}},[a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"文章关键词"},model:{value:e.Form.keywords,callback:function(t){e.$set(e.Form,"keywords",t)},expression:"Form.keywords"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文章描述：",prop:"des","inline-message":!0}},[a("el-input",{staticStyle:{width:"70%"},attrs:{type:"textarea",placeholder:"文章描述"},model:{value:e.Form.des,callback:function(t){e.$set(e.Form,"des",t)},expression:"Form.des"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文章分类：",prop:"category","inline-message":!0}},[a("div",{staticClass:"tag-box"},[a("el-checkbox-group",{model:{value:e.Form.category,callback:function(t){e.$set(e.Form,"category",t)},expression:"Form.category"}},e._l(e.category,function(t,r){return a("el-checkbox",{key:r,attrs:{label:t.value}},[e._v(e._s(t.label))])}))],1)]),e._v(" "),a("el-form-item",{attrs:{label:"文章标签：",prop:"tag","inline-message":!0}},[a("div",{staticClass:"tag-box"},[a("el-checkbox-group",{model:{value:e.Form.tag,callback:function(t){e.$set(e.Form,"tag",t)},expression:"Form.tag"}},e._l(e.tags,function(t,r){return a("el-checkbox",{key:r,attrs:{label:t.alias}},[e._v(e._s(t.name))])}))],1)]),e._v(" "),a("el-form-item",{attrs:{label:"文章内容：",prop:"content","inline-message":!0}},[a("div",{staticClass:"content-box"},[a("mavon-editor",{ref:"md",on:{imgAdd:e.imgAdd,imgDel:e.imgDel},model:{value:e.Form.content,callback:function(t){e.$set(e.Form,"content",t)},expression:"Form.content"}})],1)])],1)],1),e._v(" "),a("el-col",{staticClass:"form-right",class:{resetBg:e.edit},attrs:{lg:5,md:5,sm:24,xs:24}},[a("el-form",{ref:"dataForm2",attrs:{rules:e.rules,model:e.Form,"label-position":"top","label-width":"85px"}},[a("el-form-item",{attrs:{label:"文章来源：",prop:"origin"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.Form.origin,callback:function(t){e.$set(e.Form,"origin",t)},expression:"Form.origin"}},e._l(e.origin,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"文章状态：",prop:"status"}},[a("el-switch",{attrs:{"active-text":"直接发布","inactive-text":"存为草稿"},model:{value:e.Form.status,callback:function(t){e.$set(e.Form,"status",t)},expression:"Form.status"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否公开：",prop:"open"}},[a("el-switch",{attrs:{"active-text":"公开","inactive-text":"私密"},model:{value:e.Form.open,callback:function(t){e.$set(e.Form,"open",t)},expression:"Form.open"}})],1),e._v(" "),a("el-form-item",{staticClass:"thumb_box",attrs:{label:"缩略图：",prop:"thumb_img"}},[a("el-upload",{staticClass:"thumb-uploader",attrs:{action:e.baseapi+"/article/thumbSave",data:e.Form,"show-file-list":!1,accept:"image/*","on-success":e.handleThumbSuccess,"before-upload":e.beforeThumbUpload}},[e.Form.imageUrl?a("div",{staticClass:"el-upload-list--picture-card"},[a("img",{staticClass:"thumb",attrs:{src:e.baseapi+e.Form.imageUrl}}),e._v(" "),a("label",{staticClass:"el-upload-list__item-status-label"},[a("i",{staticClass:"el-icon-upload-success el-icon-check"})]),e._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-refresh",staticStyle:{"font-size":"14px"}},[e._v("重选")])])])]):a("i",{staticClass:"el-icon-plus thumb-uploader-icon"})])],1)],1),e._v(" "),e.edit?a("el-button",{staticClass:"submit",attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.editArticle}},[e._v("保存修改")]):a("el-button",{staticClass:"submit",attrs:{type:"primary",icon:"el-icon-arrow-up"},on:{click:e.submit}},[e._v("发布文章")])],1)],1)],1)},staticRenderFns:[]};var g=a("VU/8")(d,p,!1,function(e){a("rnx/")},"data-v-50deed58",null);t.default=g.exports},"rnx/":function(e,t){}});
//# sourceMappingURL=10.375650e40ffc2c2aef60.js.map