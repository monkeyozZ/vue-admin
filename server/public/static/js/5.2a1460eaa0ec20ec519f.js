webpackJsonp([5,10],{K8CA:function(t,e){},N3UJ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mvHQ"),l=i.n(a),o=i("Xxa5"),n=i.n(o),r=i("exGp"),s=i.n(r),c=i("mtWM"),d=i.n(c),u=i("9TmC"),m={props:{edit:{type:Boolean,default:!1},editArr:{type:Object,default:function(){}},editId:{type:String,default:""}},data:function(){var t,e,i=this,a=(t=s()(n.a.mark(function t(e,a,l){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:0===a.length&&l(new Error("至少选择一项标签"));case 1:case"end":return t.stop()}},t,i)})),function(e,i,a){return t.apply(this,arguments)});return{baseapi:"http://api.wowmonkey.cn",category:[{label:"学无止境",value:"learn"},{label:"个人归档",value:"note"},{label:"慢生活",value:"life"}],tags:["js","java","php"],origin:[{label:"原创",value:"0"},{label:"转载",value:"1"},{label:"混合",value:"2"}],Form:{title:"",keywords:"",des:"",category:[],tag:[],content:"",origin:"0",status:!0,open:!0,imageUrl:""},rules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"}],keywords:[{required:!0,message:"请输入文章关键词",trigger:"blur"}],des:[{required:!0,message:"请输入文章描述",trigger:"blur"}],category:[{validator:(e=s()(n.a.mark(function t(e,a,l){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:0===a.length&&l(new Error("至少选择一项分类"));case 1:case"end":return t.stop()}},t,i)})),function(t,i,a){return e.apply(this,arguments)}),trigger:"blur"}],tag:[{validator:a,trigger:"blur"}],content:[{required:!0,message:"请输入文章内容",trigger:"blur"}]},dialogImageUrl:"",dialogVisible:!1,content_img_arr:[]}},methods:{getTagList:function(){var t=this;u.a.getTaglist().then(function(e){0===e.data.code&&(t.tags=e.data.tagList)})},refresh:function(){window.onbeforeunload=function(){return"请确认信息是否已保存！"}},imgAdd:function(t,e){var i=this,a=new FormData;a.append("image",e),d()({url:this.baseapi+"/article/contentimg",method:"post",data:a,headers:{"Content-Type":"multipart/form-data"}}).then(function(a){if(0===a.data.code){var l={};l[e.name]=a.data.imageUrl,i.content_img_arr.push(l),i.$refs.md.$img2Url(t,i.baseapi+a.data.imageUrl)}})},imgDel:function(t){var e=this,i="";this.content_img_arr.map(function(e){for(var a in e)t[0].name===a&&(i=e[t[0].name])}),u.a.delcontentimg(i).then(function(t){0===t.data.code&&e.$notify({type:"success",title:"成功",message:t.data.message})})},handleThumbSuccess:function(t,e){0===t.code&&(this.Form.imageUrl=t.imageUrl)},beforeThumbUpload:function(t){var e=t.size/1024/1024<10;return e||this.$message.error("上传头像图片大小不能超过 10MB!"),e},editArticle:function(){var t=this;this.$refs.dataForm1.validate(function(e){e&&u.a.editOneArticle(t.editId,t.Form).then(function(e){0===e.data.code&&(t.$emit("changeEditdialogVisible"),t.$notify({type:"success",title:"成功",message:"文章修改成功"}))})})},submit:function(){var t=this;this.$refs.dataForm1.validate(function(e){e&&(t.Form.imageUrl?u.a.insert(l()(t.Form)).then(function(e){0===e.data.code&&(t.$notify({type:"success",title:"成功",message:"文章添加成功"}),t.$router.push("/article/index"))}).catch(function(e){t.$notify({type:"error",title:"失败",message:e})}):t.$notify({type:"warning",title:"警告",message:"请选择要上传的缩略图"}))})}},watch:{editArr:{handler:function(){var t=this.editArr,e=t.title,i=t.keywords,a=t.des,l=t.category,o=t.tag,n=t.content,r=t.origin,s=t.status,c=t.open,d=t.imageUrl;this.Form.title=e,this.Form.keywords=i,this.Form.des=a,this.Form.category=l,this.Form.tag=o,this.Form.content=n,this.Form.origin=r,this.Form.status=s,this.Form.open=c,this.Form.imageUrl=d}}},mounted:function(){this.getTagList(),this.refresh()}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"article_container"},[t.edit?t._e():i("el-breadcrumb",{staticClass:"path",attrs:{"separator-class":"el-icon-arrow-right"}},[i("span",{staticStyle:{float:"left"}},[t._v("当前位置：")]),t._v(" "),i("el-breadcrumb-item",[t._v("文章管理")]),t._v(" "),i("el-breadcrumb-item",{attrs:{to:{path:"/article/insert"}}},[t._v("添加文章")])],1),t._v(" "),i("el-row",[i("el-col",{staticClass:"form-left",class:{resetBg:t.edit},attrs:{lg:17,md:17,sm:24,xs:24}},[i("el-form",{ref:"dataForm1",attrs:{rules:t.rules,model:t.Form,"label-position":"left","label-width":"120px"}},[i("el-form-item",{attrs:{label:"文章标题：",prop:"title","inline-message":!0}},[i("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"文章标题"},model:{value:t.Form.title,callback:function(e){t.$set(t.Form,"title",e)},expression:"Form.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"文章关键词：",prop:"keywords","inline-message":!0}},[i("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"文章关键词"},model:{value:t.Form.keywords,callback:function(e){t.$set(t.Form,"keywords",e)},expression:"Form.keywords"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"文章描述：",prop:"des","inline-message":!0}},[i("el-input",{staticStyle:{width:"70%"},attrs:{type:"textarea",placeholder:"文章描述"},model:{value:t.Form.des,callback:function(e){t.$set(t.Form,"des",e)},expression:"Form.des"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"文章分类：",prop:"category","inline-message":!0}},[i("div",{staticClass:"tag-box"},[i("el-checkbox-group",{model:{value:t.Form.category,callback:function(e){t.$set(t.Form,"category",e)},expression:"Form.category"}},t._l(t.category,function(e,a){return i("el-checkbox",{key:a,attrs:{label:e.value}},[t._v(t._s(e.label))])}))],1)]),t._v(" "),i("el-form-item",{attrs:{label:"文章标签：",prop:"tag","inline-message":!0}},[i("div",{staticClass:"tag-box"},[i("el-checkbox-group",{model:{value:t.Form.tag,callback:function(e){t.$set(t.Form,"tag",e)},expression:"Form.tag"}},t._l(t.tags,function(e,a){return i("el-checkbox",{key:a,attrs:{label:e.alias}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),i("el-form-item",{attrs:{label:"文章内容：",prop:"content","inline-message":!0}},[i("div",{staticClass:"content-box"},[i("mavon-editor",{ref:"md",on:{imgAdd:t.imgAdd,imgDel:t.imgDel},model:{value:t.Form.content,callback:function(e){t.$set(t.Form,"content",e)},expression:"Form.content"}})],1)])],1)],1),t._v(" "),i("el-col",{staticClass:"form-right",class:{resetBg:t.edit},attrs:{lg:5,md:5,sm:24,xs:24}},[i("el-form",{ref:"dataForm2",attrs:{rules:t.rules,model:t.Form,"label-position":"top","label-width":"85px"}},[i("el-form-item",{attrs:{label:"文章来源：",prop:"origin"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.Form.origin,callback:function(e){t.$set(t.Form,"origin",e)},expression:"Form.origin"}},t._l(t.origin,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"文章状态：",prop:"status"}},[i("el-switch",{attrs:{"active-text":"直接发布","inactive-text":"存为草稿"},model:{value:t.Form.status,callback:function(e){t.$set(t.Form,"status",e)},expression:"Form.status"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"是否公开：",prop:"open"}},[i("el-switch",{attrs:{"active-text":"公开","inactive-text":"私密"},model:{value:t.Form.open,callback:function(e){t.$set(t.Form,"open",e)},expression:"Form.open"}})],1),t._v(" "),i("el-form-item",{staticClass:"thumb_box",attrs:{label:"缩略图：",prop:"thumb_img"}},[i("el-upload",{staticClass:"thumb-uploader",attrs:{action:t.baseapi+"/article/thumbSave",data:t.Form,"show-file-list":!1,accept:"image/*","on-success":t.handleThumbSuccess,"before-upload":t.beforeThumbUpload}},[t.Form.imageUrl?i("div",{staticClass:"el-upload-list--picture-card"},[i("img",{staticClass:"thumb",attrs:{src:t.baseapi+t.Form.imageUrl}}),t._v(" "),i("label",{staticClass:"el-upload-list__item-status-label"},[i("i",{staticClass:"el-icon-upload-success el-icon-check"})]),t._v(" "),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview"},[i("i",{staticClass:"el-icon-refresh",staticStyle:{"font-size":"14px"}},[t._v("重选")])])])]):i("i",{staticClass:"el-icon-plus thumb-uploader-icon"})])],1)],1),t._v(" "),t.edit?i("el-button",{staticClass:"submit",attrs:{type:"primary",icon:"el-icon-check"},on:{click:t.editArticle}},[t._v("保存修改")]):i("el-button",{staticClass:"submit",attrs:{type:"primary",icon:"el-icon-arrow-up"},on:{click:t.submit}},[t._v("发布文章")])],1)],1)],1)},staticRenderFns:[]};var p=i("VU/8")(m,f,!1,function(t){i("rnx/")},"data-v-50deed58",null);e.default=p.exports},"rnx/":function(t,e){},"wm3/":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("cAgV"),l=i("9TmC"),o=i("N3UJ"),n=i("Q0Ca"),r={directives:{waves:a.a},filters:{catefilter:n.a,formatTime:n.b,openfilter:n.c,statusfilter:n.d},components:{VEdit:o.default},data:function(){return{baseapi:"http://api.wowmonkey.cn",imgdialogVisible:!1,editdialogVisible:!1,thumb_img:"",loading:!0,filterobj:{condition:"1",condition2:"",condition3:""},filterSearch:{condition:"1",condition2:"",condition3:"",keywords:""},count:"("+this.total+")",listQuery:{page:1,limit:8},tableData:[],editArr:{},editId:"",total:"",category:[{label:"所有分类",options:[{label:"学无止境",value:"learn"},{label:"个人归档",value:"note"},{label:"慢生活",value:"life"}]}],tag:[],multipleSelection:[]}},computed:{condition:function(){return this.filterobj.condition},condition2:function(){return this.filterobj.condition2},condition3:function(){return this.filterobj.condition3}},methods:{clear:function(){this.filterobj.condition="1",this.filterobj.condition2="",this.filterobj.condition3=""},getTagList:function(){var t=this;l.a.getTaglist().then(function(e){0===e.data.code&&(t.tag=e.data.tagList)})},handleSizeChange:function(t){this.listQuery.limit=t,this.initArticleList()},handleCurrentChange:function(t){this.listQuery.page=t,this.initArticleList()},handleEdit:function(t){var e=this;this.editdialogVisible=!0,this.editId=t,l.a.getOneArticle({_id:t}).then(function(t){0===t.data.code&&(e.editArr=t.data.articleobj)})},fakeDelete:function(t){var e=this;this.$confirm("确定将该记录添加到回收站吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.fakeDelArticle({_id:t}).then(function(t){0===t.data.code?(e.initArticleList(),e.$notify({type:"success",title:"成功",message:t.data.message})):e.$notify({type:"error",title:"失败",message:t.data.message})})})},recoveryDelete:function(t){var e=this;this.$confirm("该记录将被恢复？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.recoveryDelArticle({_id:t}).then(function(t){0===t.data.code?(e.initArticleList(),e.$notify({type:"success",title:"成功",message:t.data.message})):e.$notify({type:"error",title:"失败",message:t.data.message})})})},handleDelete:function(t){var e=this;this.$confirm("确定永久删除该记录吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.delArticle({_id:t}).then(function(t){0===t.data.code?(e.initArticleList(),e.$notify({type:"success",title:"成功",message:t.data.message})):e.$notify({type:"error",title:"失败",message:t.data.message})})})},changeEditdialogVisible:function(){this.editdialogVisible=!1,this.initArticleList()},handleSelectionChange:function(t){this.multipleSelection=t},jioinImgUrl:function(t){this.imgdialogVisible=!0,this.thumb_img=t},initArticleList:function(){var t=this;l.a.articleList(this.listQuery,this.filterobj).then(function(e){0===e.data.code&&(t.tableData=e.data.articleList,t.total=e.data.total,t.loading=!1)})},search:function(){var t=this;l.a.articleList(this.listQuery,this.filterSearch).then(function(e){0===e.data.code&&(t.tableData=e.data.articleList,t.total=e.data.total,t.loading=!1)})}},watch:{filterobj:{handler:function(){this.initArticleList()},deep:!0},condition:{handler:function(){this.filterSearch.condition=this.condition}},condition2:{handler:function(){this.filterSearch.condition2=this.condition2}},condition3:{handler:function(){this.filterSearch.condition2=this.condition3}}},mounted:function(){this.getTagList(),this.initArticleList()}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"article_container"},[i("el-breadcrumb",{staticClass:"path",attrs:{"separator-class":"el-icon-arrow-right"}},[i("span",{staticStyle:{float:"left"}},[t._v("当前位置：")]),t._v(" "),i("el-breadcrumb-item",[t._v("文章管理")]),t._v(" "),i("el-breadcrumb-item",{attrs:{to:{path:"/article/index"}}},[t._v("文章列表")])],1),t._v(" "),i("div",{staticClass:"data-container"},[i("el-row",{staticClass:"filter-box"},[i("el-col",{attrs:{xs:{span:16},sm:{span:14},md:{span:10},lg:{span:8}}},[i("el-radio-group",{model:{value:t.filterobj.condition,callback:function(e){t.$set(t.filterobj,"condition",e)},expression:"filterobj.condition"}},[i("el-radio-button",{attrs:{label:"1"}},[t._v("全部")]),t._v(" "),i("el-radio-button",{attrs:{label:"2"}},[t._v("已发布")]),t._v(" "),i("el-radio-button",{attrs:{label:"3"}},[t._v("草稿箱")]),t._v(" "),i("el-radio-button",{attrs:{label:"4"}},[t._v("回收站")])],1)],1),t._v(" "),i("el-col",{attrs:{xs:8,sm:10,md:{span:11},lg:{span:12,offset:4}}},[i("el-row",{staticClass:"cate-filter-box",attrs:{gutter:10}},[i("el-col",{staticClass:"hidden-sm-and-down",attrs:{md:10,lg:5}},[i("el-button",{attrs:{icon:"el-icon-delete"},on:{click:t.clear}},[t._v("清空筛选条件")])],1),t._v(" "),i("el-col",{staticClass:"hidden-md-and-down",attrs:{md:5,lg:5}},[i("el-select",{attrs:{filterable:"",placeholder:"分类筛选"},model:{value:t.filterobj.condition2,callback:function(e){t.$set(t.filterobj,"condition2",e)},expression:"filterobj.condition2"}},t._l(t.category,function(e){return i("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))}))],1),t._v(" "),i("el-col",{staticClass:"hidden-md-and-down",attrs:{md:5,lg:5}},[i("el-select",{attrs:{filterable:"",placeholder:"标签筛选"},model:{value:t.filterobj.condition3,callback:function(e){t.$set(t.filterobj,"condition3",e)},expression:"filterobj.condition3"}},[i("el-option-group",{attrs:{label:"所有标签"}},t._l(t.tag,function(t,e){return i("el-option",{key:e,attrs:{label:t.name,value:t.alias}})}))],1)],1),t._v(" "),i("el-col",{staticClass:"hidden-sm-and-down",attrs:{md:10,lg:8}},[i("el-input",{attrs:{placeholder:"请输入关键字搜索"},model:{value:t.filterSearch.keywords,callback:function(e){t.$set(t.filterSearch,"keywords",e)},expression:"filterSearch.keywords"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.search},slot:"append"})],1)],1)],1)],1)],1),t._v(" "),i("div",{staticClass:"list-box"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",stripe:"",data:t.tableData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{label:"ID",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.id))]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"title",label:"文章标题",width:"300","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{prop:"thumb_img",label:"缩略图",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){t.jioinImgUrl(e.row.imageUrl)}}},[t._v("查看缩略图")])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"所属分类",width:"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.category,function(e,a){return i("p",{key:a},[t._v("\n              "+t._s(t._f("catefilter")(e))+"\n            ")])})}}])}),t._v(" "),i("el-table-column",{attrs:{label:"标签"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.tag,function(e,a){return i("el-tag",{key:a},[t._v(t._s(e[0].name))])})}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"comment_num",label:"评论",width:"80","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{prop:"like",label:"喜欢",width:"80","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{prop:"view",label:"浏览量",width:"80","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"日期",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(t._f("formatTime")(e.row.creat_time))+"\n          ")]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"公开",width:"80","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.open?i("el-tag",{attrs:{type:"success"}},[t._v(t._s(t._f("openfilter")(e.row.open)))]):i("el-tag",{attrs:{type:"danger"}},[t._v(t._s(t._f("openfilter")(e.row.open)))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"status",label:"状态",width:"80","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.status?i("el-tag",{attrs:{type:"success"}},[t._v(t._s(t._f("statusfilter")(e.row.status)))]):i("el-tag",{attrs:{type:"info"}},[t._v(t._s(t._f("statusfilter")(e.row.status)))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.recovery?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"primary",icon:"el-icon-back",circle:""},on:{click:function(i){t.recoveryDelete(e.row._id)}}}):i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(i){t.handleEdit(e.row._id)}}}),t._v(" "),e.row.recovery?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(i){t.handleDelete(e.row._id)}}}):i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(i){t.fakeDelete(e.row._id)}}})]}}])})],1),t._v(" "),t.total?i("div",{staticClass:"pagination-box"},[i("el-pagination",{attrs:{background:"","current-page":1,"page-sizes":[8,20,30,40],"page-size":5,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"缩略图",visible:t.imgdialogVisible,width:"30%",center:""},on:{"update:visible":function(e){t.imgdialogVisible=e}}},[i("img",{staticStyle:{display:"block",margin:"0 auto","max-width":"100%"},attrs:{src:t.baseapi+t.thumb_img,alt:""}})]),t._v(" "),i("el-dialog",{attrs:{title:"编辑文章",visible:t.editdialogVisible,width:"80%"},on:{"update:visible":function(e){t.editdialogVisible=e}}},[i("v-edit",{attrs:{edit:!0,editArr:t.editArr,editId:t.editId},on:{changeEditdialogVisible:t.changeEditdialogVisible}})],1)],1)},staticRenderFns:[]};var c=i("VU/8")(r,s,!1,function(t){i("K8CA")},"data-v-335dd2b8",null);e.default=c.exports}});
//# sourceMappingURL=5.2a1460eaa0ec20ec519f.js.map